\section{Algoritmul Distribuit: Protocolul Kerberos}

Kerberos rezolvă problema autentificării într-o rețea nesigură folosind un \textit{Trusted Third Party} (KDC). Pentru a face protocolul ușor de înțeles, îl putem privi ca pe un sistem de bilete: utilizatorul nu prezintă parola la fiecare serviciu, ci obține un "permis universal" (TGT) pe care îl schimbă ulterior pentru "bilete specifice" de acces.

\subsection{Notații Utilizate}
Pentru descrierea formală, vom folosi următoarele simboluri simplificate, conform lucrării originale \cite{steiner1988kerberos}:

% Nu mai închide multicols aici

\begin{table*}[t] % table* forțează afișarea pe toată lățimea, [t] îl pune sus
    \centering
    \begin{tabular}{|c|l|}
        \hline
        \textbf{Simbol} & \textbf{Semnificație}                                             \\
        \hline
        $C, S$          & Clientul (utilizator) și Serverul (serviciul dorit)               \\
        $AS, TGS$       & Componentele KDC: Authentication Server și Ticket-Granting Server \\
        $K_x$           & Cheia secretă a lui $x$ (ex: hash-ul parolei)                     \\
        $\{M\}_K$       & Mesajul $M$ criptat cu cheia $K$                                  \\
        $TGT$           & \textit{Ticket-Granting Ticket} (Permisul universal)              \\
        $T_{Serv}$      & Tichetul de Serviciu (pentru acces final)                         \\
        $Auth$          & Autentificatorul (dovada identității pe loc, conține timestamp)   \\
        \hline
    \end{tabular}
    \caption{Notații și Simboluri Kerberos}
    \label{tab:notatii}
\end{table*}

% Continuă textul normal în două coloane...

\subsection{Fluxul Protocolului (Cele 3 Faze)}

Protocolul este împărțit în trei etape logice.

\subsubsection{Faza 1: Autentificarea Inițială (Logarea)}
\textbf{Scop:} Clientul vrea să demonstreze cine este, fără a trimite parola prin rețea.

În această fază, clientul inițiază protocolul pentru a obține credențialele necesare interacțiunii ulterioare. Figura de mai jos ilustrează schimbul de mesaje, unde axa timpului curge de sus în jos.

\begin{figure}[H]
    \centering
    % \resizebox forțează diagrama să se micșoreze la lățimea coloanei curente
    \resizebox{\linewidth}{!}{
        \centering
        \input{chapters/figures/as_exchange.tex}
    } % <--- Aceasta este acolada care lipsea!
    \caption{Diagrama de secvență pentru Autentificarea Inițială (AS Exchange)}
    \label{fig:as_exchange}
\end{figure}

După acest schimb, clientul deține cheia de sesiune decriptată și TGT-ul opac, fiind pregătit pentru Faza 2.


\subsubsection{Faza 2: Obținerea Tichetului de Serviciu (TGS Exchange)}
\textbf{Scop:} Clientul are TGT-ul (permisul) și vrea să acceseze un server specific ($S$), de exemplu un Server de Fișiere.

Utilizând cheia de sesiune obținută anterior, clientul generează un \textit{Autentificator} pentru a dovedi că este posesorul legitim al TGT-ului.

\begin{figure}[H]
    \centering
    % Resizebox asigură că diagrama încape perfect în coloană
    \resizebox{\linewidth}{!}{
        \input{chapters/figures/tgs_exchange.tex}
    }
    \caption{Diagrama de secvență pentru TGS Exchange}
    \label{fig:tgs_exchange}
\end{figure}

TGS-ul verifică timestamp-ul din autentificator pentru a preveni atacurile de tip \textit{replay}. Dacă totul este valid, clientul primește noul tichet ($T_{Serv}$) și noua cheie de sesiune ($K_{C,S}$).

\subsubsection{Faza 3: Accesarea Serviciului (Client-Server Exchange)}
\textbf{Scop:} Clientul prezintă tichetul final serverului.

\begin{figure}[H]
    \centering
    % \resizebox asigură scalarea automată la lățimea coloanei
    \resizebox{\linewidth}{!}{
        \input{chapters/figures/cs_exchange.tex}
    }
    \caption{Diagrama Client-Server Exchange}
    \label{fig:cs_exchange}
\end{figure}

\subsection{De ce este acest sistem sigur?}
\begin{enumerate}
    \item \textbf{Parola nu circulă niciodată:} Ea este folosită doar local pe stația clientului pentru a decripta primul mesaj de la AS.
    \item \textbf{Protecție la Replay:} Datorită Autentificatorului care conține \textit{Timestamp}, un atacator care interceptează pachetele nu le poate refolosi mai târziu, deoarece serverul va respinge cererile cu ora veche.
    \item \textbf{Minimizarea riscului:} Serverul de aplicație nu trebuie să știe parola utilizatorului, ci doar să poată decripta tichetul emis de KDC.
\end{enumerate}

\subsection{Replicarea și Administrarea Datelor}
Pentru a asigura disponibilitatea și toleranța la defecte (fault tolerance), Kerberos nu rulează pe un singur nod, ci folosește o arhitectură distribuită de tip \textbf{Master-Slave} pentru baza de date de credențiale.

\subsubsection{Arhitectura Master-Slave}
Baza de date este replicată pe mai multe servere KDC:
\begin{itemize}
    \item \textbf{Master KDC:} Este singurul nod care permite operații de scriere (adăugare utilizatori, schimbare parole). Acesta gestionează copia autoritativă a bazei de date.
    \item \textbf{Slave KDCs:} Sunt noduri \textit{Read-Only}. Acestea primesc periodic actualizări de la Master. Clientul se poate autentifica la orice Slave disponibil. Dacă Master-ul pică, autentificarea funcționează în continuare prin Slave-uri, dar nu se pot schimba parole.
\end{itemize}

Această separare este crucială pentru performanța sistemului distribuit, deoarece cererile de citire (autentificările frecvente) sunt balansate între multiple replici, în timp ce scrierile (rare) sunt centralizate pentru consistență.

\subsubsection{Serviciul de Administrare (KDBM)}
Modificările asupra bazei de date se fac exclusiv prin protocolul administrativ, gestionat de procesul \texttt{kadmind}. Deoarece baza de date conține cheile secrete ale tuturor utilizatorilor, acest serviciu rulează doar pe nodul Master și necesită o autentificare strictă.
